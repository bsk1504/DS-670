{"paragraphs":[{"text":"%sh\nwget http://stat-computing.org/dataexpo/2009/2007.csv.bz2 -0 /tmp/flights_2007.csv.bz2\nwget http://stat-computing.org/dataexpo/2009/2008.csv.bz2 -0 /tmp/flights_2008.csv.bz2\nwget ftp://ftp.ncdc.noaa.gov/pub/data/ghcn/daily/by_year/2007.csv.gz -0 /tmp/weather_2007.csv.gz\nwget ftp://ftp.ncdc.noaa.gov/pub/data/ghcn/daily/by_year/2008.csv.gz -0 /tmp/weather_2008.csv.gz\necho \"downloaded\"","dateUpdated":"2017-02-02T19:36:23-0500","config":{"colWidth":12,"graph":{"mode":"table","height":91,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486074916862_-1842191556","id":"20170202-173516_1938275285","result":{"code":"SUCCESS","type":"TEXT","msg":"bash: wget: command not found\nbash: line 1: wget: command not found\nbash: line 2: wget: command not found\nbash: line 3: wget: command not found\ndownloaded\n"},"dateCreated":"2017-02-02T05:35:16-0500","dateStarted":"2017-02-02T19:31:28-0500","dateFinished":"2017-02-02T19:31:28-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:702","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486082476375_1468867398","id":"20170202-194116_1455645533","dateCreated":"2017-02-02T19:41:16-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1020","dateUpdated":"2017-02-02T20:28:38-0500","dateFinished":"2017-02-02T20:28:43-0500","dateStarted":"2017-02-02T20:28:38-0500","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.rdd._\n\nimport scala.collection.JavaConverters._\n\nimport au.com.bytecode.opencsv.CSVReader\n\nimport java.io._\n\nimport org.joda.time._\n\nimport org.joda.time.format._\n\nimport org.joda.time.format.DateTimeFormat\n\nimport org.joda.time.DateTime\n\nimport org.joda.time.Days\n"},"text":"%spark\n\nimport org.apache.spark.rdd._\nimport scala.collection.JavaConverters._\nimport au.com.bytecode.opencsv.CSVReader\n\nimport java.io._\nimport org.joda.time._\nimport org.joda.time.format._\nimport org.joda.time.format.DateTimeFormat\nimport org.joda.time.DateTime\nimport org.joda.time.Days\n\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486082601323_1237953473","id":"20170202-194321_454994241","dateCreated":"2017-02-02T19:43:21-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1760","dateUpdated":"2017-02-02T20:29:34-0500","dateFinished":"2017-02-02T20:29:36-0500","dateStarted":"2017-02-02T20:29:34-0500","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class DelayRec\n"},"text":"case class DelayRec(year: String,\n                    month: String,\n                    dayOfMonth: String,\n                    dayOfWeek: String,\n                    crsDepTime: String,\n                    depDelay: String,\n                    origin: String,\n                    distance: String,\n                    cancelled: String) {\n\n    val holidays = List(\"01/01/2007\", \"01/15/2007\", \"02/19/2007\", \"05/28/2007\", \"06/07/2007\", \"07/04/2007\",\n      \"09/03/2007\", \"10/08/2007\" ,\"11/11/2007\", \"11/22/2007\", \"12/25/2007\",\n      \"01/01/2008\", \"01/21/2008\", \"02/18/2008\", \"05/22/2008\", \"05/26/2008\", \"07/04/2008\",\n      \"09/01/2008\", \"10/13/2008\" ,\"11/11/2008\", \"11/27/2008\", \"12/25/2008\")\n\n    def gen_features: (String, Array[Double]) = {\n      val values = Array(\n        depDelay.toDouble,\n        month.toDouble,\n        dayOfMonth.toDouble,\n        dayOfWeek.toDouble,\n        get_hour(crsDepTime).toDouble,\n        distance.toDouble,\n        days_from_nearest_holiday(year.toInt, month.toInt, dayOfMonth.toInt)\n      )\n      new Tuple2(to_date(year.toInt, month.toInt, dayOfMonth.toInt), values)\n    }\n    def get_hour(depTime: String) : String = \"%04d\".format(depTime.toInt).take(2)\n    def to_date(year: Int, month: Int, day: Int) = \"%04d%02d%02d\".format(year, month, day)\n\n    def days_from_nearest_holiday(year:Int, month:Int, day:Int): Int = {\n      val sampleDate = new org.joda.time.DateTime(year, month, day, 0, 0)\n\n      holidays.foldLeft(3000) { (r, c) =>\n        val holiday = org.joda.time.format.DateTimeFormat.forPattern(\"MM/dd/yyyy\").parseDateTime(c)\n        val distance = Math.abs(org.joda.time.Days.daysBetween(holiday, sampleDate).getDays)\n        math.min(r, distance)\n      }\n    }\n  }"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486083040989_1024691500","id":"20170202-195040_684707189","dateCreated":"2017-02-02T19:50:40-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2028","dateUpdated":"2017-02-02T20:30:43-0500","dateFinished":"2017-02-02T20:31:04-0500","dateStarted":"2017-02-02T20:30:43-0500","result":{"code":"SUCCESS","type":"TEXT","msg":"\nprepFlightDelays: (infile: String)org.apache.spark.rdd.RDD[DelayRec]\n\ndata_2007tmp: org.apache.spark.rdd.RDD[DelayRec] = MapPartitionsRDD[55] at filter at <console>:77\n\ndata_2007: org.apache.spark.rdd.RDD[Array[Double]] = MapPartitionsRDD[56] at map at <console>:71\n\ndata_2008: org.apache.spark.rdd.RDD[Array[Double]] = MapPartitionsRDD[64] at map at <console>:69\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n-8.0,1.0,25.0,4.0,11.0,719.0,10.0\n41.0,1.0,28.0,7.0,15.0,925.0,13.0\n45.0,1.0,29.0,1.0,20.0,316.0,14.0\n-9.0,1.0,17.0,3.0,19.0,719.0,2.0\n180.0,1.0,12.0,5.0,17.0,316.0,3.0\n"},"text":"// function to do a preprocessing step for a given file\ndef prepFlightDelays(infile: String): RDD[DelayRec] = {\n    val data = sc.textFile(infile)\n\n    data.map { line =>\n      val reader = new CSVReader(new StringReader(line))\n      reader.readAll().asScala.toList.map(rec => DelayRec(rec(0),rec(1),rec(2),rec(3),rec(5),rec(15),rec(16),rec(18),rec(21)))\n    }.map(list => list(0))\n    .filter(rec => rec.year != \"Year\")\n    .filter(rec => rec.cancelled == \"0\")\n    .filter(rec => rec.origin == \"ORD\")\n}\n\nval data_2007tmp = prepFlightDelays(\"/Users/datascienceadmin/Downloads/2007.csv\")\nval data_2007 = data_2007tmp.map(rec => rec.gen_features._2)\nval data_2008 = prepFlightDelays(\"/Users/datascienceadmin/Downloads/2008.csv\").map(rec => rec.gen_features._2)\n\ndata_2007tmp.toDF().registerTempTable(\"data_2007tmp\")\n\ndata_2007.take(5).map(x => x mkString \",\").foreach(println)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486084179660_-501812655","id":"20170202-200939_749520095","dateCreated":"2017-02-02T20:09:39-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2129","dateUpdated":"2017-02-02T20:37:22-0500","dateFinished":"2017-02-02T20:37:50-0500","dateStarted":"2017-02-02T20:37:22-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"dayofWeek\tCASE WHEN (CAST(depDelay AS DOUBLE) > CAST(15 AS DOUBLE)) THEN delayed ELSE ok END\tcount(1)\n1\tdelayed\t16983\n7\tok\t35455\n1\tok\t36815\n6\tdelayed\t10924\n2\tdelayed\t14990\n3\tok\t36975\n4\tdelayed\t16716\n3\tdelayed\t15315\n5\tok\t36823\n2\tok\t37023\n6\tok\t34261\n4\tok\t35680\n5\tdelayed\t16267\n7\tdelayed\t14942\n","comment":"","msgTable":[[{"key":"CASE WHEN (CAST(depDelay AS DOUBLE) > CAST(15 AS DOUBLE)) THEN delayed ELSE ok END","value":"1"},{"key":"CASE WHEN (CAST(depDelay AS DOUBLE) > CAST(15 AS DOUBLE)) THEN delayed ELSE ok END","value":"delayed"},{"key":"CASE WHEN (CAST(depDelay AS DOUBLE) > CAST(15 AS DOUBLE)) THEN delayed ELSE ok END","value":"16983"}],[{"key":"count(1)","value":"7"},{"key":"count(1)","value":"ok"},{"key":"count(1)","value":"35455"}],[{"value":"1"},{"value":"ok"},{"value":"36815"}],[{"value":"6"},{"value":"delayed"},{"value":"10924"}],[{"value":"2"},{"value":"delayed"},{"value":"14990"}],[{"value":"3"},{"value":"ok"},{"value":"36975"}],[{"value":"4"},{"value":"delayed"},{"value":"16716"}],[{"value":"3"},{"value":"delayed"},{"value":"15315"}],[{"value":"5"},{"value":"ok"},{"value":"36823"}],[{"value":"2"},{"value":"ok"},{"value":"37023"}],[{"value":"6"},{"value":"ok"},{"value":"34261"}],[{"value":"4"},{"value":"ok"},{"value":"35680"}],[{"value":"5"},{"value":"delayed"},{"value":"16267"}],[{"value":"7"},{"value":"delayed"},{"value":"14942"}]],"columnNames":[{"name":"dayofWeek","index":0,"aggr":"sum"},{"name":"CASE WHEN (CAST(depDelay AS DOUBLE) > CAST(15 AS DOUBLE)) THEN delayed ELSE ok END","index":1,"aggr":"sum"},{"name":"count(1)","index":2,"aggr":"sum"}],"rows":[["1","delayed","16983"],["7","ok","35455"],["1","ok","36815"],["6","delayed","10924"],["2","delayed","14990"],["3","ok","36975"],["4","delayed","16716"],["3","delayed","15315"],["5","ok","36823"],["2","ok","37023"],["6","ok","34261"],["4","ok","35680"],["5","delayed","16267"],["7","delayed","14942"]]},"text":"%sql\nselect dayofWeek, case when depDelay > 15 then 'delayed' else 'ok' end , count(1)\nfrom data_2007tmp\ngroup by dayofweek, case when depDelay > 15 then 'delayed' else 'ok' end \n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"hour","index":0,"aggr":"sum"}],"values":[{"name":"delay","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"hour","index":0,"aggr":"sum"},"yAxis":{"name":"delay","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486085758300_1970248289","id":"20170202-203558_1231606605","dateCreated":"2017-02-02T20:35:58-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2378","dateUpdated":"2017-02-02T20:43:13-0500","dateFinished":"2017-02-02T20:43:38-0500","dateStarted":"2017-02-02T20:43:13-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"hour\tdelay\tcount\n12\tok\t13244\n13\tok\t20922\n20\tdelayed\t10582\n10\tok\t17864\n19\tok\t12774\n15\tok\t14597\n15\tdelayed\t7707\n21\tok\t8048\n8\tok\t20450\n5\tok\t832\n12\tdelayed\t4595\n20\tok\t13791\n10\tdelayed\t5427\n5\tdelayed\t82\n9\tdelayed\t6398\n6\tdelayed\t1966\n6\tok\t15826\n16\tdelayed\t8585\n21\tdelayed\t5427\n13\tdelayed\t7891\n18\tdelayed\t9222\n22\tok\t1637\n16\tok\t14886\n22\tdelayed\t862\n9\tok\t23768\n11\tdelayed\t5314\n14\tok\t13250\n8\tdelayed\t4007\n7\tok\t19420\n11\tok\t15675\n18\tok\t12644\n14\tdelayed\t6345\n17\tok\t13404\n19\tdelayed\t9738\n17\tdelayed\t8696\n7\tdelayed\t3293\n","comment":"","msgTable":[[{"key":"delay","value":"12"},{"key":"delay","value":"ok"},{"key":"delay","value":"13244"}],[{"key":"count","value":"13"},{"key":"count","value":"ok"},{"key":"count","value":"20922"}],[{"value":"20"},{"value":"delayed"},{"value":"10582"}],[{"value":"10"},{"value":"ok"},{"value":"17864"}],[{"value":"19"},{"value":"ok"},{"value":"12774"}],[{"value":"15"},{"value":"ok"},{"value":"14597"}],[{"value":"15"},{"value":"delayed"},{"value":"7707"}],[{"value":"21"},{"value":"ok"},{"value":"8048"}],[{"value":"8"},{"value":"ok"},{"value":"20450"}],[{"value":"5"},{"value":"ok"},{"value":"832"}],[{"value":"12"},{"value":"delayed"},{"value":"4595"}],[{"value":"20"},{"value":"ok"},{"value":"13791"}],[{"value":"10"},{"value":"delayed"},{"value":"5427"}],[{"value":"5"},{"value":"delayed"},{"value":"82"}],[{"value":"9"},{"value":"delayed"},{"value":"6398"}],[{"value":"6"},{"value":"delayed"},{"value":"1966"}],[{"value":"6"},{"value":"ok"},{"value":"15826"}],[{"value":"16"},{"value":"delayed"},{"value":"8585"}],[{"value":"21"},{"value":"delayed"},{"value":"5427"}],[{"value":"13"},{"value":"delayed"},{"value":"7891"}],[{"value":"18"},{"value":"delayed"},{"value":"9222"}],[{"value":"22"},{"value":"ok"},{"value":"1637"}],[{"value":"16"},{"value":"ok"},{"value":"14886"}],[{"value":"22"},{"value":"delayed"},{"value":"862"}],[{"value":"9"},{"value":"ok"},{"value":"23768"}],[{"value":"11"},{"value":"delayed"},{"value":"5314"}],[{"value":"14"},{"value":"ok"},{"value":"13250"}],[{"value":"8"},{"value":"delayed"},{"value":"4007"}],[{"value":"7"},{"value":"ok"},{"value":"19420"}],[{"value":"11"},{"value":"ok"},{"value":"15675"}],[{"value":"18"},{"value":"ok"},{"value":"12644"}],[{"value":"14"},{"value":"delayed"},{"value":"6345"}],[{"value":"17"},{"value":"ok"},{"value":"13404"}],[{"value":"19"},{"value":"delayed"},{"value":"9738"}],[{"value":"17"},{"value":"delayed"},{"value":"8696"}],[{"value":"7"},{"value":"delayed"},{"value":"3293"}]],"columnNames":[{"name":"hour","index":0,"aggr":"sum"},{"name":"delay","index":1,"aggr":"sum"},{"name":"count","index":2,"aggr":"sum"}],"rows":[["12","ok","13244"],["13","ok","20922"],["20","delayed","10582"],["10","ok","17864"],["19","ok","12774"],["15","ok","14597"],["15","delayed","7707"],["21","ok","8048"],["8","ok","20450"],["5","ok","832"],["12","delayed","4595"],["20","ok","13791"],["10","delayed","5427"],["5","delayed","82"],["9","delayed","6398"],["6","delayed","1966"],["6","ok","15826"],["16","delayed","8585"],["21","delayed","5427"],["13","delayed","7891"],["18","delayed","9222"],["22","ok","1637"],["16","ok","14886"],["22","delayed","862"],["9","ok","23768"],["11","delayed","5314"],["14","ok","13250"],["8","delayed","4007"],["7","ok","19420"],["11","ok","15675"],["18","ok","12644"],["14","delayed","6345"],["17","ok","13404"],["19","delayed","9738"],["17","delayed","8696"],["7","delayed","3293"]]},"text":"%sql\n\nselect cast( cast(crsDepTime as int) / 100 as int) as hour,  case when depDelay > 15 then 'delayed' else 'ok' end as delay, count(1) as count\nfrom  data_2007tmp \ngroup by  cast( cast(crsDepTime as int) / 100 as int),  case when depDelay > 15 then 'delayed' else 'ok' end"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486086144634_1381569316","id":"20170202-204224_1646138694","dateCreated":"2017-02-02T20:42:24-0500","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2500","dateUpdated":"2017-02-02T20:42:35-0500","text":""}],"name":"2/2 thurs","id":"2C87CGG11","angularObjects":{"2CARZSHST:shared_process":[],"2C8BERMEY:shared_process":[],"2C9CHDSA6:shared_process":[],"2C7V5E1FN:shared_process":[],"2C8DW2CH1:shared_process":[],"2C81M8MKD:shared_process":[],"2C8D1R16Q:shared_process":[],"2C9J9SSXQ:shared_process":[],"2C9EPT5JX:shared_process":[],"2C92A9UM2:shared_process":[],"2C9PHZM2S:shared_process":[],"2C9V9VRP4:shared_process":[],"2C97U1TUX:shared_process":[],"2C9RCK4NH:shared_process":[],"2C7RF31XW:shared_process":[],"2C9JFZ7QG:shared_process":[],"2C83ZBFS1:shared_process":[],"2C9ZN7PCT:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}